
var Cookie={data:{},options:{expires:1,domain:"",path:"",secure:false},init:function(options,data){Cookie.options=Object.extend(Cookie.options,options||{});var payload=Cookie.retrieve();if(payload){Cookie.data=payload.evalJSON();}else{Cookie.data=data||{};};Cookie.store();},getData:function(key){return Cookie.data[key];},setData:function(key,value){Cookie.data[key]=value;Cookie.store();},removeData:function(key){delete Cookie.data[key];Cookie.store();},retrieve:function(){var start=document.cookie.indexOf(Cookie.options.name+"="),len=-1,end=-1;if(start===-1){return null;};if(Cookie.options.name!==document.cookie.substr(start,Cookie.options.name.length)){return null;};len=start+Cookie.options.name.length+1;end=document.cookie.indexOf(';',len);if(end===-1){end=document.cookie.length;};return unescape(document.cookie.substring(len,end));},store:function(){var expires='',today=new Date();if(Cookie.options.expires){expires=Cookie.options.expires*86400000;expires=';expires='+new Date(today.getTime()+expires);};document.cookie=Cookie.options.name+'='+escape(Object.toJSON(Cookie.data))+Cookie.getOptions()+expires;},erase:function(){document.cookie=Cookie.options.name+'='+Cookie.getOptions()+';expires=Thu, 01-Jan-1970 00:00:01 GMT';},getOptions:function(){return(Cookie.options.path?';path='+Cookie.options.path:'')+(Cookie.options.domain?';domain='+Cookie.options.domain:'')+(Cookie.options.secure?';secure':'');}};var ajaxWin={contents:'',json:[],loaded:false,show:function(json){ajaxWin.json=json;ajaxWin.buildContents();if(this.loaded){ajaxWin.activateWindow();}else{Event.observe(window,'load',ajaxWin.activateWindow);};},buildContents:function(){var json=ajaxWin.json;ajaxWin.contents='<a onclick="'+(json.cnclFunc?json.cnclFunc:'')+' ajaxWin.cancelWindow(); return false" class="close_btn" title="'+(json.cnclText?json.cnclText:'Cancel')+'" ></a>';ajaxWin.contents+='<div class="hdr" id="ajaxWinHdr">';if(json.title){ajaxWin.contents+=json.title;};ajaxWin.contents+='</div>';ajaxWin.contents+='<div id="ajaxWinBody">';if(json.hdrTxt||json.hdrIcon){ajaxWin.contents+='<table class="ndnt">';ajaxWin.contents+='<tr>';if(json.hdrIcon){ajaxWin.contents+='<td class="m"><img src="'+json.hdrIcon+'" alt="" style="padding-right:6px" /></td>';};ajaxWin.contents+='<td class="m"><strong class="'+json.hdrTxtClass+'">'+json.hdrTxt+'</strong></td>';ajaxWin.contents+='</tr>';ajaxWin.contents+='</table>';};ajaxWin.contents+=json.cntnt;ajaxWin.contents+='</div>';if(json.footer){ajaxWin.contents+='<div class="clear"></div>';ajaxWin.contents+='<div id="ajaxWinFtr" class="ftr">';ajaxWin.contents+=json.footer;ajaxWin.contents+='</div>';};},activateWindow:function(){var json=ajaxWin.json;var ins;if(!json.contentDiv){var content='cntnt';}else{var content=json.contentDiv;}
if(!$('ajaxWin')){ins=new Insertion.Bottom(content,'<div id="ajaxWinBG" style="display:none;" ></div>');ins=new Insertion.Bottom(content,'<div id="ajaxWin" class="dropshadow" style="display:none;" ><div id = "ajaxWinWrapper">'+ajaxWin.contents+'</div></div>');}else{$('ajaxWin').hide();$('ajaxWinWrapper').update(ajaxWin.contents);};if(typeof(json.wdth)!='undefined'){$('ajaxWin').style.width=json.wdth+10+'px';};var w=$('ajaxWin').getWidth();var h=$('ajaxWin').getHeight();var viewportDims=document.viewport.getDimensions();var scrollOffsets=document.viewport.getScrollOffsets();$('ajaxWinBG').style.width=(viewportDims.width*3)+scrollOffsets.left+'px';$('ajaxWinBG').style.height=(viewportDims.height*3)+scrollOffsets.top+'px';$('ajaxWin').style.top=Math.max(0,parseInt((viewportDims.height/2)-(h/2)+scrollOffsets.top,10))+'px';$('ajaxWin').style.left=Math.max(0,parseInt((viewportDims.width/2)-(w/2)+scrollOffsets.left,10))+'px';$('ajaxWinBG').show();$('ajaxWin').show();var draggable=new Draggable('ajaxWin',{handle:'ajaxWinHdr'});if(draggable){$('ajaxWinHdr').setStyle('cursor:move');}
Event.observe(document,'keypress',function(e){if(e.keyCode==27){ajaxWin.cancelWindow();}});document.fire('ajax_widget_window:open');},cancelWindow:function(){if($('ajaxWin')){$('ajaxWin').remove();}
if($('ajaxWinBG')){$('ajaxWinBG').remove();}
document.fire('ajax_widget_window:closed');Event.stopObserving(document,'keypress');}};Event.observe(window,'load',function(){ajaxWin.loaded=true;});try{document.fire('ajax_widget_window:loaded');}catch(e){}
namespacing.init('istock.gigya');istock.gigya.header={getConf:function(){return{APIKey:istock.gigya.apiKey,lang:istock.gigya.languageCode};}};namespacing.init('istock.gigya.templates');istock.gigya.templates.spambox=new Template('<table style="height: 75px; margin: 0; padding: 0;">'+'<tr>'+'<td style="text-align:center; font-weight: bold; padding: 0; padding-right: 5px;">'+'<div style="padding-top: 10px;"><img src="http://i.istockimg.com/static/images/timeIcon.png"></div>'+'<div>-0:30</div>'+'</td>'+'<td style="padding: 0; padding-top: 10px; vertical-align: top; line-height: 100%">'+'#{message}'+'</td>'+'</tr>'+'</table>');namespacing.init('istock.gigya');istock.gigya.throttle={gigyaThrottle:function(){var currentTime=new Date().getTime(),currentCount,expiryTime;Cookie.init({name:'gigyaShare',domain:'.istockphoto.com',expires:1});Cookie.retrieve();currentCount=Cookie.getData('count');expiryTime=Cookie.getData('expiryTime');if((!expiryTime)||(currentTime>expiryTime)){expiryTime=currentTime+istock.gigya.shareBarThrottle;Cookie.setData('expiryTime',expiryTime);Cookie.setData('count',0);return false;}
if(parseInt(currentCount,10)===3){expiryTime=currentTime+istock.gigya.shareBarCoolDown;Cookie.setData('expiryTime',expiryTime);Cookie.setData('count',currentCount+1);return true;}
if(parseInt(currentCount,10)>3){return true;}
return false;},showSpamBox:function(){var spamBoxContent=istock.gigya.templates.spambox;var info={'title':translations.istock.gigya.throttleTitle,'cntnt':spamBoxContent.evaluate({message:translations.istock.gigya.throttleMessage}),'contentDiv':istock.gigya.divContentId,'footer':'','wdth':300};ajaxWin.show(info);$("ajaxWinBG").setStyle({opacity:0});$('ajaxWinBG').observe('click',function(){ajaxWin.cancelWindow();});},shareSuccessful:function(){var currentCount;Cookie.init({name:'gigyaShare',domain:'.istockphoto.com',expires:1});currentCount=Cookie.getData('count');if(!currentCount){currentCount=0;}
currentCount+=1;Cookie.setData('count',currentCount);return;},onLoadEventModify:function(){$$('.gig-button').each(function(button){var oldEvent=button.onclick;button.onclick=function(){if(istock.gigya.throttle.gigyaThrottle()===false){oldEvent();}else{istock.gigya.throttle.showSpamBox();}};});}};document.observe('gigya:shareBarLoaded',function(){istock.gigya.throttle.onLoadEventModify();});namespacing.init('istock.gigya');istock.gigya.information={getAct:function(){var act=new gigya.services.socialize.UserAction();var gigyaInfo=istock.gigya.provider.def;act.setUserMessage(gigyaInfo.message);act.setTitle(gigyaInfo.title);act.setLinkBack(gigyaInfo.linkBack);act.setDescription(gigyaInfo.description);act.addActionLink(gigyaInfo.actionText,gigyaInfo.actionUrl);return act;}};namespacing.init('istock.gigya');(function(g){g.LinkBackOverride=Class.create({initialize:function(links){if(!links||links.length<=0){return;}
this._links=g.links;this._overrideLinks(g.params);},_overrideObserver:function(provider){var el=$(provider.container+'-reaction'+provider.index),oldEvent=el.onclick;el.onclick=function(){if(this._links[provider.name]){g.params[provider.container].userAction.linkBack=this._links[provider.name];}
oldEvent();}.bind(this);},_overrideLinks:function(params){var i,key;for(key in params){if(params.hasOwnProperty(key)){for(i=0;i<params[key].shareButtons.length;i++){if('provider'in params[key].shareButtons[i]){this._overrideObserver({name:params[key].shareButtons[i].provider,index:i,container:key});}}}}}});document.observe('gigya:shareBarLoaded',function(){if(g.links){var lo=new g.LinkBackOverride(g.links);}});}(istock.gigya));